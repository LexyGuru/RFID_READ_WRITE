<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NTAG216 NFC - Teljes Alkalmaz√°s</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 900px;
      margin: 0 auto;
    }
    
    h1 {
      color: #333;
      margin-bottom: 10px;
      text-align: center;
      font-size: 2em;
    }
    
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid #e0e0e0;
      flex-wrap: wrap;
    }
    
    .tab {
      padding: 12px 20px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      color: #666;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }
    
    .tab:hover {
      color: #667eea;
    }
    
    .tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .section {
      margin-bottom: 30px;
    }
    
    .section-title {
      font-size: 1.3em;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e0e0e0;
    }
    
    .input-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
    }
    
    input, textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s;
      font-family: inherit;
    }
    
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    input:focus, textarea:focus {
      outline: none;
      border-color: #667eea;
    }
    
    button {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      margin-top: 10px;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    button.danger {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }
    
    button.warning {
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      color: #333;
    }
    
    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
      white-space: pre-wrap;
    }
    
    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .status.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    
    .status.warning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
    
    .help-text {
      font-size: 0.85em;
      color: #888;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üì± NTAG216 NFC</h1>
    <p class="subtitle">Teljes funkcionalit√°s - V√©delmi be√°ll√≠t√°sokkal</p>
    
    <div class="tabs">
      <button class="tab active" data-tab="ndef">NDEF √úzenetek</button>
      <button class="tab" data-tab="security">üîí V√©delmi Be√°ll√≠t√°sok</button>
      <button class="tab" data-tab="raw">Raw Byte M≈±veletek</button>
      <button class="tab" data-tab="info">‚ÑπÔ∏è Inform√°ci√≥</button>
    </div>
    
    <!-- NDEF √úzenetek Tab -->
    <div id="ndef" class="tab-content active">
      <div class="section">
        <h2 class="section-title">üìù URL √çr√°sa/Olvas√°sa</h2>
        <div class="input-group">
          <label for="url">URL:</label>
          <input type="text" id="url" placeholder="https://example.com" />
        </div>
        <div class="input-group">
          <label for="writePassword">Password (opcion√°lis, 8 hex karakter):</label>
          <input type="text" id="writePassword" placeholder="12345678" maxlength="8" />
          <div class="help-text">Ha a c√≠mke password v√©dett, add meg a password-t (8 hex karakter = 4 byte)</div>
        </div>
        <div class="grid">
          <button id="writeUrlBtn">üìù URL √çr√°sa</button>
          <button id="readUrlBtn">üìñ URL Olvas√°sa</button>
        </div>
      </div>
      
      <div class="section">
        <h2 class="section-title">üìÑ Sz√∂veg √çr√°sa/Olvas√°sa</h2>
        <div class="input-group">
          <label for="text">Sz√∂veg:</label>
          <textarea id="text" placeholder="√çrd ide a sz√∂veget..."></textarea>
        </div>
        <div class="input-group">
          <label for="language">Nyelv k√≥d (pl: hu, en):</label>
          <input type="text" id="language" placeholder="hu" value="hu" maxlength="5" />
        </div>
        <div class="input-group">
          <label for="writePasswordText">Password (opcion√°lis, 8 hex karakter):</label>
          <input type="text" id="writePasswordText" placeholder="12345678" maxlength="8" />
          <div class="help-text">Ha a c√≠mke password v√©dett, add meg a password-t (8 hex karakter = 4 byte)</div>
        </div>
        <div class="grid">
          <button id="writeTextBtn">üìù Sz√∂veg √çr√°sa</button>
          <button id="readTextBtn">üìñ Sz√∂veg Olvas√°sa</button>
        </div>
      </div>
      
      <div class="section">
        <h2 class="section-title">üë§ vCard √çr√°sa/Olvas√°sa</h2>
        <div class="input-group">
          <label for="vcard">vCard adatok:</label>
          <textarea id="vcard" placeholder="BEGIN:VCARD
VERSION:3.0
FN:Kov√°cs J√°nos
TEL:+3612345678
EMAIL:kovacs@example.com
END:VCARD"></textarea>
          <div class="help-text">vCard 3.0 form√°tum</div>
        </div>
        <div class="input-group">
          <label for="writePasswordVcard">Password (opcion√°lis, 8 hex karakter):</label>
          <input type="text" id="writePasswordVcard" placeholder="12345678" maxlength="8" />
          <div class="help-text">Ha a c√≠mke password v√©dett, add meg a password-t (8 hex karakter = 4 byte)</div>
        </div>
        <div class="grid">
          <button id="writeVcardBtn">üìù vCard √çr√°sa</button>
          <button id="readVcardBtn">üìñ vCard Olvas√°sa</button>
        </div>
      </div>
      
      <div class="section">
        <h2 class="section-title">üóëÔ∏è NDEF T√∂rl√©s</h2>
        <div class="input-group">
          <label for="writePasswordClear">Password (opcion√°lis, 8 hex karakter):</label>
          <input type="text" id="writePasswordClear" placeholder="12345678" maxlength="8" />
          <div class="help-text">Ha a c√≠mke password v√©dett, add meg a password-t (8 hex karakter = 4 byte)</div>
        </div>
        <button id="clearNdefBtn" class="danger">üóëÔ∏è NDEF √úzenet T√∂rl√©se</button>
      </div>
    </div>
    
    <!-- V√©delmi Be√°ll√≠t√°sok Tab -->
    <div id="security" class="tab-content">
      <div class="section">
        <h2 class="section-title">üîê Password V√©delem</h2>
        <div class="input-group">
          <label for="password">Password (4 byte hex, pl: 12345678):</label>
          <input type="text" id="password" placeholder="12345678" maxlength="8" />
          <div class="help-text">8 hexadecim√°lis karakter (4 byte)</div>
        </div>
        <div class="input-group">
          <label for="pack">PACK (2 byte hex, pl: 8080):</label>
          <input type="text" id="pack" placeholder="8080" maxlength="4" value="8080" />
          <div class="help-text">4 hexadecim√°lis karakter (2 byte), alap√©rtelmezett: 8080</div>
        </div>
        <div class="input-group">
          <label for="authLimit">Auth Limit (max pr√≥b√°lkoz√°sok):</label>
          <input type="number" id="authLimit" placeholder="3" value="3" min="1" max="255" />
          <div class="help-text">H√°ny rossz password ut√°n z√°rol√≥dik a c√≠mke</div>
        </div>
        <div class="grid">
          <button id="setPasswordBtn">üîê Password Be√°ll√≠t√°sa</button>
          <button id="removePasswordBtn" class="danger">üîì Password Elt√°vol√≠t√°sa</button>
        </div>
      </div>
      
      <div class="section">
        <h2 class="section-title">üîí Read-Only M√≥d</h2>
        <div class="status warning">
          ‚ö†Ô∏è FIGYELEM: A Read-Only m√≥d be√°ll√≠t√°sa VISSZAFORD√çTHATATLAN! 
          A c√≠mke soha t√∂bb√© nem lesz √≠rhat√≥!
        </div>
        <button id="setReadOnlyBtn" class="warning">üîí Read-Only M√≥d Be√°ll√≠t√°sa</button>
      </div>
      
      <div class="section">
        <h2 class="section-title">üìä Konfigur√°ci√≥ Olvas√°sa</h2>
        <button id="readConfigBtn">üìä Konfigur√°ci√≥ Megjelen√≠t√©se</button>
      </div>
    </div>
    
    <!-- Raw Byte M≈±veletek Tab -->
    <div id="raw" class="tab-content">
      <div class="section">
        <h2 class="section-title">üíæ Raw Byte √çr√°sa</h2>
        <div class="input-group">
          <label for="startBlock">Kezd≈ë Block (4-129):</label>
          <input type="number" id="startBlock" placeholder="4" value="4" min="4" max="129" />
        </div>
        <div class="input-group">
          <label for="rawData">Adatok (hex, pl: 03 11 D1 01):</label>
          <input type="text" id="rawData" placeholder="03 11 D1 01" />
          <div class="help-text">Hexadecim√°lis √©rt√©kek sz√≥k√∂zzel elv√°lasztva</div>
        </div>
        <div class="input-group">
          <label for="writePasswordRaw">Password (opcion√°lis, 8 hex karakter):</label>
          <input type="text" id="writePasswordRaw" placeholder="12345678" maxlength="8" />
          <div class="help-text">Ha a c√≠mke password v√©dett, add meg a password-t (8 hex karakter = 4 byte)</div>
        </div>
        <button id="writeRawBtn">üíæ Raw Byte √çr√°sa</button>
      </div>
      
      <div class="section">
        <h2 class="section-title">üìñ Raw Byte Olvas√°sa</h2>
        <div class="input-group">
          <label for="readStartBlock">Kezd≈ë Block (4-129):</label>
          <input type="number" id="readStartBlock" placeholder="4" value="4" min="4" max="129" />
        </div>
        <div class="input-group">
          <label for="readCount">Olvasand√≥ byte-ok sz√°ma:</label>
          <input type="number" id="readCount" placeholder="16" value="16" min="1" max="504" />
        </div>
        <button id="readRawBtn">üìñ Raw Byte Olvas√°sa</button>
      </div>
    </div>
    
    <!-- Inform√°ci√≥ Tab -->
    <div id="info" class="tab-content">
      <div class="section">
        <h2 class="section-title">üîç NFC Olvas√≥k</h2>
        <button id="checkReadersBtn">üîç Olvas√≥k Ellen≈ërz√©se</button>
      </div>
      
      <div class="section">
        <h2 class="section-title">‚ÑπÔ∏è Inform√°ci√≥</h2>
        <div class="status info">
          <strong>NTAG216 NFC Alkalmaz√°s</strong><br><br>
          <strong>Funkci√≥k:</strong><br>
          ‚Ä¢ NDEF URL √≠r√°sa/olvas√°sa<br>
          ‚Ä¢ NDEF Text √≠r√°sa/olvas√°sa<br>
          ‚Ä¢ NDEF vCard √≠r√°sa/olvas√°sa<br>
          ‚Ä¢ Password v√©delem be√°ll√≠t√°sa<br>
          ‚Ä¢ Read-only m√≥d (visszaford√≠thatatlan!)<br>
          ‚Ä¢ Raw byte √≠r√°sa/olvas√°sa<br>
          ‚Ä¢ Konfigur√°ci√≥ olvas√°sa<br>
          ‚Ä¢ NDEF √ºzenet t√∂rl√©se<br><br>
          <strong>Haszn√°lat:</strong><br>
          1. V√°laszd ki a k√≠v√°nt m≈±veletet<br>
          2. T√∂ltsd ki a mez≈ëket<br>
          3. Kattints a gombra<br>
          4. Helyezd a c√≠mk√©t az olvas√≥ra<br>
          5. V√°rd meg az eredm√©nyt
        </div>
      </div>
    </div>
    
    <div id="status"></div>
  </div>

  <script type="module">
    import { invoke } from '@tauri-apps/api/tauri';
    
    // Tab kezel√©s
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const tabName = tab.dataset.tab;
        
        // Tab akt√≠v √°llapot
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        // Content megjelen√≠t√©s
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
      });
    });
    
    // Status megjelen√≠t√©s
    const statusDiv = document.getElementById('status');
    function showStatus(message, type) {
      statusDiv.textContent = message;
      statusDiv.className = `status ${type}`;
      statusDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    // Helper: hex string -> byte array
    function hexToBytes(hex) {
      const cleaned = hex.replace(/\s+/g, '');
      const bytes = [];
      for (let i = 0; i < cleaned.length; i += 2) {
        bytes.push(parseInt(cleaned.substr(i, 2), 16));
      }
      return bytes;
    }
    
    // Helper: byte array -> hex string
    function bytesToHex(bytes) {
      return Array.from(bytes).map(b => b.toString(16).padStart(2, '0').toUpperCase()).join(' ');
    }
    
    // URL m≈±veletek
    document.getElementById('writeUrlBtn').addEventListener('click', async () => {
      const url = document.getElementById('url').value.trim();
      if (!url) {
        showStatus('K√©rlek adj meg egy URL-t!', 'error');
        return;
      }
      
      const passwordHex = document.getElementById('writePassword').value.trim();
      let password = null;
      if (passwordHex) {
        if (passwordHex.length !== 8) {
          showStatus('A password pontosan 8 hex karakter kell legyen!', 'error');
          return;
        }
        password = hexToBytes(passwordHex);
        if (password.length !== 4) {
          showStatus('√ârv√©nytelen hex form√°tum!', 'error');
          return;
        }
      }
      
      const btn = document.getElementById('writeUrlBtn');
      btn.disabled = true;
      showStatus('URL √≠r√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('write_url', { url, password });
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    document.getElementById('readUrlBtn').addEventListener('click', async () => {
      const btn = document.getElementById('readUrlBtn');
      btn.disabled = true;
      showStatus('URL olvas√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const url = await invoke('read_url');
        document.getElementById('url').value = url;
        showStatus(`Sikeres olvas√°s! ‚úÖ\nURL: ${url}`, 'success');
        setTimeout(() => window.open(url, '_blank'), 500);
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // Text m≈±veletek
    document.getElementById('writeTextBtn').addEventListener('click', async () => {
      const text = document.getElementById('text').value.trim();
      const language = document.getElementById('language').value.trim() || 'hu';
      if (!text) {
        showStatus('K√©rlek adj meg egy sz√∂veget!', 'error');
        return;
      }
      
      const passwordHex = document.getElementById('writePasswordText').value.trim();
      let password = null;
      if (passwordHex) {
        if (passwordHex.length !== 8) {
          showStatus('A password pontosan 8 hex karakter kell legyen!', 'error');
          return;
        }
        password = hexToBytes(passwordHex);
        if (password.length !== 4) {
          showStatus('√ârv√©nytelen hex form√°tum!', 'error');
          return;
        }
      }
      
      const btn = document.getElementById('writeTextBtn');
      btn.disabled = true;
      showStatus('Sz√∂veg √≠r√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('write_text', { text, language, password });
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    document.getElementById('readTextBtn').addEventListener('click', async () => {
      const btn = document.getElementById('readTextBtn');
      btn.disabled = true;
      showStatus('Sz√∂veg olvas√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('read_text');
        showStatus(`Sikeres olvas√°s! ‚úÖ\n${result}`, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // vCard m≈±veletek
    document.getElementById('writeVcardBtn').addEventListener('click', async () => {
      const vcard = document.getElementById('vcard').value.trim();
      if (!vcard) {
        showStatus('K√©rlek adj meg vCard adatokat!', 'error');
        return;
      }
      
      const passwordHex = document.getElementById('writePasswordVcard').value.trim();
      let password = null;
      if (passwordHex) {
        if (passwordHex.length !== 8) {
          showStatus('A password pontosan 8 hex karakter kell legyen!', 'error');
          return;
        }
        password = hexToBytes(passwordHex);
        if (password.length !== 4) {
          showStatus('√ârv√©nytelen hex form√°tum!', 'error');
          return;
        }
      }
      
      const btn = document.getElementById('writeVcardBtn');
      btn.disabled = true;
      showStatus('vCard √≠r√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('write_vcard', { vcard, password });
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    document.getElementById('readVcardBtn').addEventListener('click', async () => {
      const btn = document.getElementById('readVcardBtn');
      btn.disabled = true;
      showStatus('vCard olvas√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('read_vcard');
        document.getElementById('vcard').value = result;
        showStatus('Sikeres olvas√°s! ‚úÖ', 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // Password m≈±veletek
    document.getElementById('setPasswordBtn').addEventListener('click', async () => {
      const passwordHex = document.getElementById('password').value.trim();
      const packHex = document.getElementById('pack').value.trim() || '8080';
      const authLimit = parseInt(document.getElementById('authLimit').value) || 3;
      
      if (passwordHex.length !== 8) {
        showStatus('A password pontosan 8 hex karakter kell legyen!', 'error');
        return;
      }
      
      try {
        const password = hexToBytes(passwordHex);
        const pack = hexToBytes(packHex);
        
        if (password.length !== 4 || pack.length !== 2) {
          showStatus('√ârv√©nytelen hex form√°tum!', 'error');
          return;
        }
        
        const btn = document.getElementById('setPasswordBtn');
        btn.disabled = true;
        showStatus('Password be√°ll√≠t√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
        
        console.log('Frontend: set_password h√≠v√°s:', { password, pack, authLimit });
        const result = await invoke('set_password', { 
          password, 
          pack, 
          authLimit: authLimit  // camelCase Tauri v1-ben
        });
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        document.getElementById('setPasswordBtn').disabled = false;
      }
    });
    
    document.getElementById('removePasswordBtn').addEventListener('click', async () => {
      if (!confirm('Biztosan elt√°vol√≠tod a password v√©delmet?')) return;
      
      const btn = document.getElementById('removePasswordBtn');
      btn.disabled = true;
      showStatus('Password elt√°vol√≠t√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('remove_password');
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // Read-only
    document.getElementById('setReadOnlyBtn').addEventListener('click', async () => {
      if (!confirm('‚ö†Ô∏è FIGYELEM: A Read-Only m√≥d VISSZAFORD√çTHATATLAN!\n\nBiztosan folytatod?')) {
        return;
      }
      
      const btn = document.getElementById('setReadOnlyBtn');
      btn.disabled = true;
      showStatus('Read-only m√≥d be√°ll√≠t√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'warning');
      try {
        const result = await invoke('set_read_only');
        showStatus(result, 'warning');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // Konfigur√°ci√≥ olvas√°sa
    document.getElementById('readConfigBtn').addEventListener('click', async () => {
      const btn = document.getElementById('readConfigBtn');
      btn.disabled = true;
      showStatus('Konfigur√°ci√≥ olvas√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('read_config');
        showStatus(`Konfigur√°ci√≥:\n${result}`, 'info');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // NDEF t√∂rl√©s
    document.getElementById('clearNdefBtn').addEventListener('click', async () => {
      if (!confirm('Biztosan t√∂r√∂lni szeretn√©d az NDEF √ºzenetet?')) return;
      
      const passwordHex = document.getElementById('writePasswordClear').value.trim();
      let password = null;
      if (passwordHex) {
        if (passwordHex.length !== 8) {
          showStatus('A password pontosan 8 hex karakter kell legyen!', 'error');
          return;
        }
        password = hexToBytes(passwordHex);
        if (password.length !== 4) {
          showStatus('√ârv√©nytelen hex form√°tum!', 'error');
          return;
        }
      }
      
      const btn = document.getElementById('clearNdefBtn');
      btn.disabled = true;
      showStatus('NDEF t√∂rl√©se folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('clear_ndef', { password });
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // Raw byte √≠r√°sa
    document.getElementById('writeRawBtn').addEventListener('click', async () => {
      const startBlock = parseInt(document.getElementById('startBlock').value) || 4;
      const rawDataHex = document.getElementById('rawData').value.trim();
      
      if (!rawDataHex) {
        showStatus('K√©rlek adj meg hex adatokat!', 'error');
        return;
      }
      
      const passwordHex = document.getElementById('writePasswordRaw').value.trim();
      let password = null;
      if (passwordHex) {
        if (passwordHex.length !== 8) {
          showStatus('A password pontosan 8 hex karakter kell legyen!', 'error');
          return;
        }
        password = hexToBytes(passwordHex);
        if (password.length !== 4) {
          showStatus('√ârv√©nytelen hex form√°tum!', 'error');
          return;
        }
      }
      
      try {
        const data = hexToBytes(rawDataHex);
        const btn = document.getElementById('writeRawBtn');
        btn.disabled = true;
        showStatus('Raw byte √≠r√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
        
        const result = await invoke('write_raw', { start_block: startBlock, data, password });
        showStatus(result, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        document.getElementById('writeRawBtn').disabled = false;
      }
    });
    
    // Raw byte olvas√°sa
    document.getElementById('readRawBtn').addEventListener('click', async () => {
      const startBlock = parseInt(document.getElementById('readStartBlock').value) || 4;
      const count = parseInt(document.getElementById('readCount').value) || 16;
      
      const btn = document.getElementById('readRawBtn');
      btn.disabled = true;
      showStatus('Raw byte olvas√°sa folyamatban... Helyezd a c√≠mk√©t az olvas√≥ra.', 'info');
      try {
        const result = await invoke('read_raw', { start_block: startBlock, count });
        showStatus(`Olvasott adatok (hex):\n${result}`, 'success');
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
    
    // Olvas√≥k ellen≈ërz√©se
    document.getElementById('checkReadersBtn').addEventListener('click', async () => {
      const btn = document.getElementById('checkReadersBtn');
      btn.disabled = true;
      showStatus('Olvas√≥k ellen≈ërz√©se...', 'info');
      try {
        const readers = await invoke('list_readers');
        if (readers && readers.length > 0) {
          showStatus(`Csatlakoztatott olvas√≥k:\n${readers.join('\n')}`, 'success');
        } else {
          showStatus('Nincs NFC olvas√≥ csatlakoztatva!', 'error');
        }
      } catch (error) {
        showStatus(`Hiba: ${error}`, 'error');
      } finally {
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
