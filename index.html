<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFC Rust - NTAG216 URL Writer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 14px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }

        .tag-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 14px;
        }

        .tag-info strong {
            color: #333;
        }

        .uid-display {
            font-family: 'Courier New', monospace;
            color: #667eea;
            word-break: break-all;
        }

        .url-display {
            color: #764ba2;
            word-break: break-all;
            margin-top: 5px;
        }

        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 30px 0;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.8s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± NFC Rust</h1>
        <p class="subtitle">NTAG216 URL √≠r√°s √©s olvas√°s</p>

        <!-- NFC Olvas√≥ st√°tusz -->
        <div class="section">
            <div class="section-title">NFC Olvas√≥</div>
            <div id="reader-status" class="status info">
                NFC olvas√≥ ellen≈ërz√©se...
            </div>
        </div>

        <div class="divider"></div>

        <!-- NDEF √≠r√°s -->
        <div class="section">
            <div class="section-title">‚úçÔ∏è NDEF √ºzenet √≠r√°sa c√≠mk√©re</div>
            <div class="input-group">
                <label for="record-type-select">Rekord t√≠pus:</label>
                <select id="record-type-select" style="width: 100%; padding: 12px 16px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                    <option value="uri">üîó URL/Link</option>
                    <option value="text">üìù Sz√∂veg</option>
                    <option value="wifi">üì∂ WiFi konfigur√°ci√≥</option>
                    <option value="bluetooth">üîµ Bluetooth p√°ros√≠t√°s</option>
                    <option value="vcard">üë§ vCard (N√©vjegy)</option>
                    <option value="email">üìß Email</option>
                    <option value="sms">üí¨ SMS</option>
                    <option value="phone">üìû Telefonsz√°m</option>
                </select>
            </div>
            
            <!-- URI mez≈ëk -->
            <div class="input-group" id="url-input-group">
                <label for="url-input">URL c√≠m:</label>
                <input type="text" id="url-input" placeholder="https://example.com" value="https://www.tauri.app">
            </div>
            
            <!-- Text mez≈ëk -->
            <div class="input-group" id="text-input-group" style="display: none;">
                <label for="text-input">Sz√∂veg:</label>
                <input type="text" id="text-input" placeholder="√çrj ide egy sz√∂veget...">
            </div>
            <div class="input-group" id="language-input-group" style="display: none;">
                <label for="language-input">Nyelv k√≥d (pl: hu, en):</label>
                <input type="text" id="language-input" placeholder="hu" value="hu" maxlength="5">
            </div>
            
            <!-- WiFi mez≈ëk -->
            <div class="input-group" id="wifi-ssid-group" style="display: none;">
                <label for="wifi-ssid-input">WiFi SSID:</label>
                <input type="text" id="wifi-ssid-input" placeholder="WiFi h√°l√≥zat neve">
            </div>
            <div class="input-group" id="wifi-password-group" style="display: none;">
                <label for="wifi-password-input">WiFi jelsz√≥:</label>
                <input type="password" id="wifi-password-input" placeholder="WiFi jelsz√≥">
            </div>
            <div class="input-group" id="wifi-security-group" style="display: none;">
                <label for="wifi-security-select">Biztons√°gi t√≠pus:</label>
                <select id="wifi-security-select" style="width: 100%; padding: 12px 16px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                    <option value="wpa2">WPA2</option>
                    <option value="wpa">WPA</option>
                    <option value="wep">WEP</option>
                    <option value="open">Nyitott (nincs jelsz√≥)</option>
                </select>
            </div>
            
            <!-- Bluetooth mez≈ëk -->
            <div class="input-group" id="bluetooth-mac-group" style="display: none;">
                <label for="bluetooth-mac-input">Bluetooth MAC c√≠m (XX:XX:XX:XX:XX:XX):</label>
                <input type="text" id="bluetooth-mac-input" placeholder="00:11:22:33:44:55" maxlength="17">
            </div>
            
            <!-- vCard mez≈ëk -->
            <div class="input-group" id="vcard-name-group" style="display: none;">
                <label for="vcard-name-input">N√©v:</label>
                <input type="text" id="vcard-name-input" placeholder="Teljes n√©v">
            </div>
            <div class="input-group" id="vcard-phone-group" style="display: none;">
                <label for="vcard-phone-input">Telefonsz√°m:</label>
                <input type="text" id="vcard-phone-input" placeholder="+36 20 123 4567">
            </div>
            <div class="input-group" id="vcard-email-group" style="display: none;">
                <label for="vcard-email-input">Email:</label>
                <input type="email" id="vcard-email-input" placeholder="pelda@example.com">
            </div>
            <div class="input-group" id="vcard-org-group" style="display: none;">
                <label for="vcard-org-input">Szervezet/C√©g:</label>
                <input type="text" id="vcard-org-input" placeholder="C√©g neve">
            </div>
            
            <!-- Email mez≈ëk -->
            <div class="input-group" id="email-address-group" style="display: none;">
                <label for="email-address-input">Email c√≠m:</label>
                <input type="email" id="email-address-input" placeholder="pelda@example.com">
            </div>
            <div class="input-group" id="email-subject-group" style="display: none;">
                <label for="email-subject-input">T√°rgy (opcion√°lis):</label>
                <input type="text" id="email-subject-input" placeholder="Email t√°rgya">
            </div>
            <div class="input-group" id="email-body-group" style="display: none;">
                <label for="email-body-input">√úzenet (opcion√°lis):</label>
                <textarea id="email-body-input" placeholder="Email √ºzenet" rows="3" style="width: 100%; padding: 12px 16px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; font-family: inherit;"></textarea>
            </div>
            
            <!-- SMS mez≈ëk -->
            <div class="input-group" id="sms-phone-group" style="display: none;">
                <label for="sms-phone-input">Telefonsz√°m:</label>
                <input type="text" id="sms-phone-input" placeholder="+36 20 123 4567">
            </div>
            <div class="input-group" id="sms-message-group" style="display: none;">
                <label for="sms-message-input">√úzenet (opcion√°lis):</label>
                <textarea id="sms-message-input" placeholder="SMS √ºzenet" rows="3" style="width: 100%; padding: 12px 16px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; font-family: inherit;"></textarea>
            </div>
            
            <!-- Phone mez≈ëk -->
            <div class="input-group" id="phone-number-group" style="display: none;">
                <label for="phone-number-input">Telefonsz√°m:</label>
                <input type="text" id="phone-number-input" placeholder="+36 20 123 4567">
            </div>
            <button id="write-btn" onclick="writeNdef()">
                NDEF √ºzenet √≠r√°sa NTAG216 c√≠mk√©re
            </button>
            <div id="write-status" class="status"></div>
            <div id="write-tag-info" class="tag-info" style="display: none;"></div>
        </div>

        <div class="divider"></div>

        <!-- NDEF olvas√°s -->
        <div class="section">
            <div class="section-title">üìñ NDEF √ºzenet olvas√°sa c√≠mk√©b≈ël</div>
            <button id="read-btn" onclick="readNdef()">
                NDEF √ºzenet olvas√°sa NTAG216 c√≠mk√©b≈ël
            </button>
            <div id="read-status" class="status"></div>
            <div id="read-tag-info" class="tag-info" style="display: none;"></div>
        </div>
    </div>

    <script type="module">
        import { invoke } from '@tauri-apps/api/tauri';
        import { open } from '@tauri-apps/api/shell';

        window.invoke = invoke;
        window.openUrl = open;

        // NFC olvas√≥ ellen≈ërz√©se
        async function checkNFC() {
            const statusEl = document.getElementById('reader-status');
            try {
                const available = await invoke('check_nfc_available');
                if (available) {
                    const readers = await invoke('list_nfc_readers');
                    statusEl.className = 'status success';
                    statusEl.textContent = `‚úÖ NFC olvas√≥ el√©rhet≈ë: ${readers.join(', ')}`;
                } else {
                    statusEl.className = 'status error';
                    statusEl.textContent = '‚ùå Nincs NFC olvas√≥ csatlakoztatva';
                }
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = `‚ùå Hiba: ${error}`;
            }
        }

        // Rekord t√≠pus v√°ltoztat√°s kezel√©se
        document.getElementById('record-type-select').addEventListener('change', function() {
            const recordType = this.value;
            
            // √ñsszes mez≈ë elrejt√©se
            document.getElementById('url-input-group').style.display = 'none';
            document.getElementById('text-input-group').style.display = 'none';
            document.getElementById('language-input-group').style.display = 'none';
            document.getElementById('wifi-ssid-group').style.display = 'none';
            document.getElementById('wifi-password-group').style.display = 'none';
            document.getElementById('wifi-security-group').style.display = 'none';
            document.getElementById('bluetooth-mac-group').style.display = 'none';
            document.getElementById('vcard-name-group').style.display = 'none';
            document.getElementById('vcard-phone-group').style.display = 'none';
            document.getElementById('vcard-email-group').style.display = 'none';
            document.getElementById('vcard-org-group').style.display = 'none';
            document.getElementById('email-address-group').style.display = 'none';
            document.getElementById('email-subject-group').style.display = 'none';
            document.getElementById('email-body-group').style.display = 'none';
            document.getElementById('sms-phone-group').style.display = 'none';
            document.getElementById('sms-message-group').style.display = 'none';
            document.getElementById('phone-number-group').style.display = 'none';
            
            // Relev√°ns mez≈ëk megjelen√≠t√©se
            if (recordType === 'uri') {
                document.getElementById('url-input-group').style.display = 'block';
            } else if (recordType === 'text') {
                document.getElementById('text-input-group').style.display = 'block';
                document.getElementById('language-input-group').style.display = 'block';
            } else if (recordType === 'wifi') {
                document.getElementById('wifi-ssid-group').style.display = 'block';
                document.getElementById('wifi-password-group').style.display = 'block';
                document.getElementById('wifi-security-group').style.display = 'block';
            } else if (recordType === 'bluetooth') {
                document.getElementById('bluetooth-mac-group').style.display = 'block';
            } else if (recordType === 'vcard') {
                document.getElementById('vcard-name-group').style.display = 'block';
                document.getElementById('vcard-phone-group').style.display = 'block';
                document.getElementById('vcard-email-group').style.display = 'block';
                document.getElementById('vcard-org-group').style.display = 'block';
            } else if (recordType === 'email') {
                document.getElementById('email-address-group').style.display = 'block';
                document.getElementById('email-subject-group').style.display = 'block';
                document.getElementById('email-body-group').style.display = 'block';
            } else if (recordType === 'sms') {
                document.getElementById('sms-phone-group').style.display = 'block';
                document.getElementById('sms-message-group').style.display = 'block';
            } else if (recordType === 'phone') {
                document.getElementById('phone-number-group').style.display = 'block';
            }
        });

        // NDEF √ºzenet √≠r√°sa
        window.writeNdef = async function() {
            const recordTypeSelect = document.getElementById('record-type-select');
            const writeBtn = document.getElementById('write-btn');
            const statusEl = document.getElementById('write-status');
            const tagInfoEl = document.getElementById('write-tag-info');

            const recordType = recordTypeSelect.value;
            writeBtn.disabled = true;
            writeBtn.innerHTML = '<span class="loading"></span>√çr√°s folyamatban... Olvass be egy NTAG216 c√≠mk√©t!';
            statusEl.className = 'status info';
            statusEl.textContent = '‚è≥ V√°rakoz√°s c√≠mk√©re... Olvass be egy NTAG216 c√≠mk√©t az olvas√≥ra!';
            tagInfoEl.style.display = 'none';

            try {
                let result;
                if (recordType === 'uri') {
                    const url = document.getElementById('url-input').value.trim();
                    if (!url) throw new Error('K√©rlek adj meg egy URL-t!');
                    try { new URL(url); } catch { throw new Error('√ârv√©nytelen URL form√°tum!'); }
                    result = await invoke('write_url_to_ntag216', { url });
                } else if (recordType === 'text') {
                    const text = document.getElementById('text-input').value.trim();
                    const language = document.getElementById('language-input').value.trim() || 'hu';
                    if (!text) throw new Error('K√©rlek adj meg egy sz√∂veget!');
                    result = await invoke('write_text_to_ntag216', { text, language });
                } else if (recordType === 'wifi') {
                    const ssid = document.getElementById('wifi-ssid-input').value.trim();
                    const password = document.getElementById('wifi-password-input').value.trim();
                    const security = document.getElementById('wifi-security-select').value;
                    if (!ssid) throw new Error('K√©rlek adj meg egy WiFi SSID-t!');
                    result = await invoke('write_wifi_to_ntag216', { ssid, password, security });
                } else if (recordType === 'bluetooth') {
                    const mac = document.getElementById('bluetooth-mac-input').value.trim();
                    if (!mac) throw new Error('K√©rlek adj meg egy Bluetooth MAC c√≠met!');
                    if (!/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/.test(mac)) {
                        throw new Error('√ârv√©nytelen MAC c√≠m form√°tum! Haszn√°ld a XX:XX:XX:XX:XX:XX form√°tumot.');
                    }
                    result = await invoke('write_bluetooth_to_ntag216', { mac_address: mac });
                } else if (recordType === 'vcard') {
                    const name = document.getElementById('vcard-name-input').value.trim();
                    const phone = document.getElementById('vcard-phone-input').value.trim();
                    const email = document.getElementById('vcard-email-input').value.trim();
                    const org = document.getElementById('vcard-org-input').value.trim();
                    if (!name && !phone && !email) throw new Error('K√©rlek adj meg legal√°bb egy adatot (n√©v, telefon vagy email)!');
                    result = await invoke('write_vcard_to_ntag216', { name, phone, email, organization: org });
                } else if (recordType === 'email') {
                    const email = document.getElementById('email-address-input').value.trim();
                    const subject = document.getElementById('email-subject-input').value.trim();
                    const body = document.getElementById('email-body-input').value.trim();
                    if (!email) throw new Error('K√©rlek adj meg egy email c√≠met!');
                    result = await invoke('write_email_to_ntag216', { email, subject, body });
                } else if (recordType === 'sms') {
                    const phone = document.getElementById('sms-phone-input').value.trim();
                    const message = document.getElementById('sms-message-input').value.trim();
                    if (!phone) throw new Error('K√©rlek adj meg egy telefonsz√°mot!');
                    result = await invoke('write_sms_to_ntag216', { phone, message });
                } else if (recordType === 'phone') {
                    const phone = document.getElementById('phone-number-input').value.trim();
                    if (!phone) throw new Error('K√©rlek adj meg egy telefonsz√°mot!');
                    result = await invoke('write_phone_to_ntag216', { phone });
                } else {
                    throw new Error('Ismeretlen rekord t√≠pus!');
                }
                
                writeBtn.disabled = false;
                writeBtn.textContent = 'NDEF √ºzenet √≠r√°sa NTAG216 c√≠mk√©re';
                
                statusEl.className = 'status success';
                const typeNames = {
                    'uri': 'URL', 'text': 'Sz√∂veg', 'wifi': 'WiFi konfigur√°ci√≥',
                    'bluetooth': 'Bluetooth p√°ros√≠t√°s', 'vcard': 'vCard', 'email': 'Email',
                    'sms': 'SMS', 'phone': 'Telefonsz√°m'
                };
                statusEl.textContent = `‚úÖ ${typeNames[recordType] || '√úzenet'} sikeresen √≠rva a c√≠mk√©re!`;
                
                tagInfoEl.style.display = 'block';
                let infoHtml = `<strong>UID:</strong> <span class="uid-display">${result.uid.map(b => b.toString(16).padStart(2, '0').toUpperCase()).join(':')}</span><br>`;
                if (result.url) infoHtml += `<strong>URL:</strong> <span class="url-display">${result.url}</span><br>`;
                if (result.text) infoHtml += `<strong>Sz√∂veg:</strong> ${result.text}<br><strong>Nyelv:</strong> ${result.language || 'N/A'}<br>`;
                if (result.wifi_ssid) infoHtml += `<strong>WiFi SSID:</strong> ${result.wifi_ssid}<br><strong>Biztons√°g:</strong> ${result.wifi_security || 'N/A'}<br>`;
                if (result.bluetooth_mac) infoHtml += `<strong>Bluetooth MAC:</strong> ${result.bluetooth_mac}<br>`;
                if (result.vcard_name) infoHtml += `<strong>N√©v:</strong> ${result.vcard_name}<br>`;
                if (result.vcard_phone) infoHtml += `<strong>Telefon:</strong> ${result.vcard_phone}<br>`;
                if (result.vcard_email) infoHtml += `<strong>Email:</strong> ${result.vcard_email}<br>`;
                if (result.email_address) infoHtml += `<strong>Email:</strong> ${result.email_address}<br>`;
                if (result.sms_phone) infoHtml += `<strong>SMS Telefon:</strong> ${result.sms_phone}<br>`;
                if (result.phone_number) infoHtml += `<strong>Telefon:</strong> ${result.phone_number}<br>`;
                tagInfoEl.innerHTML = infoHtml;
            } catch (error) {
                writeBtn.disabled = false;
                writeBtn.textContent = 'NDEF √ºzenet √≠r√°sa NTAG216 c√≠mk√©re';
                statusEl.className = 'status error';
                statusEl.textContent = `‚ùå Hiba: ${error}`;
            }
        };

        // URL √≠r√°sa (kompatibilit√°s)
        window.writeUrl = async function() {
            const urlInput = document.getElementById('url-input');
            const writeBtn = document.getElementById('write-btn');
            const statusEl = document.getElementById('write-status');
            const tagInfoEl = document.getElementById('write-tag-info');

            const url = urlInput.value.trim();
            if (!url) {
                statusEl.className = 'status error';
                statusEl.textContent = '‚ùå K√©rlek adj meg egy URL-t!';
                return;
            }

            // URL valid√°l√°s
            try {
                new URL(url);
            } catch {
                statusEl.className = 'status error';
                statusEl.textContent = '‚ùå √ârv√©nytelen URL form√°tum!';
                return;
            }

            writeBtn.disabled = true;
            writeBtn.innerHTML = '<span class="loading"></span>√çr√°s folyamatban... Olvass be egy NTAG216 c√≠mk√©t!';
            statusEl.className = 'status info';
            statusEl.textContent = '‚è≥ V√°rakoz√°s c√≠mk√©re... Olvass be egy NTAG216 c√≠mk√©t az olvas√≥ra!';
            tagInfoEl.style.display = 'none';

            try {
                const result = await invoke('write_url_to_ntag216', { url });
                
                writeBtn.disabled = false;
                writeBtn.textContent = 'URL √≠r√°sa NTAG216 c√≠mk√©re';
                
                statusEl.className = 'status success';
                statusEl.textContent = '‚úÖ URL sikeresen √≠rva a c√≠mk√©re!';
                
                tagInfoEl.style.display = 'block';
                tagInfoEl.innerHTML = `
                    <strong>UID:</strong> <span class="uid-display">${result.uid.map(b => b.toString(16).padStart(2, '0').toUpperCase()).join(':')}</span><br>
                    <strong>URL:</strong> <span class="url-display">${result.url || 'N/A'}</span>
                `;
            } catch (error) {
                writeBtn.disabled = false;
                writeBtn.textContent = 'URL √≠r√°sa NTAG216 c√≠mk√©re';
                
                statusEl.className = 'status error';
                statusEl.textContent = `‚ùå Hiba: ${error}`;
            }
        };

        // NDEF √ºzenet olvas√°sa
        window.readNdef = async function() {
            const readBtn = document.getElementById('read-btn');
            const statusEl = document.getElementById('read-status');
            const tagInfoEl = document.getElementById('read-tag-info');

            readBtn.disabled = true;
            readBtn.innerHTML = '<span class="loading"></span>Olvas√°s folyamatban... Olvass be egy NTAG216 c√≠mk√©t!';
            statusEl.className = 'status info';
            statusEl.textContent = '‚è≥ V√°rakoz√°s c√≠mk√©re... Olvass be egy NTAG216 c√≠mk√©t az olvas√≥ra!';
            tagInfoEl.style.display = 'none';

            try {
                const result = await invoke('read_ntag216');
                
                readBtn.disabled = false;
                readBtn.textContent = 'NDEF √ºzenet olvas√°sa NTAG216 c√≠mk√©b≈ël';
                
                tagInfoEl.style.display = 'block';
                let infoHtml = `<strong>UID:</strong> <span class="uid-display">${result.uid.map(b => b.toString(16).padStart(2, '0').toUpperCase()).join(':')}</span><br>`;
                
                const typeEmojis = {
                    'uri': 'üîó', 'text': 'üìù', 'wifi': 'üì∂', 'bluetooth': 'üîµ',
                    'vcard': 'üë§', 'email': 'üìß', 'sms': 'üí¨', 'phone': 'üìû'
                };
                const typeNames = {
                    'uri': 'URL', 'text': 'Sz√∂veg', 'wifi': 'WiFi', 'bluetooth': 'Bluetooth',
                    'vcard': 'vCard', 'email': 'Email', 'sms': 'SMS', 'phone': 'Telefon'
                };
                
                const recordType = result.record_type || 'unknown';
                infoHtml += `<strong>T√≠pus:</strong> ${typeEmojis[recordType] || '‚ùì'} ${typeNames[recordType] || 'Ismeretlen'}<br>`;
                
                if (result.url) infoHtml += `<strong>URL:</strong> <span class="url-display">${result.url}</span><br>`;
                if (result.text) infoHtml += `<strong>Sz√∂veg:</strong> ${result.text}<br><strong>Nyelv:</strong> ${result.language || 'N/A'}<br>`;
                if (result.wifi_ssid) infoHtml += `<strong>WiFi SSID:</strong> ${result.wifi_ssid}<br><strong>Biztons√°g:</strong> ${result.wifi_security || 'N/A'}<br>`;
                if (result.bluetooth_mac) infoHtml += `<strong>Bluetooth MAC:</strong> ${result.bluetooth_mac}<br>`;
                if (result.vcard_name) infoHtml += `<strong>N√©v:</strong> ${result.vcard_name}<br>`;
                if (result.vcard_phone) infoHtml += `<strong>Telefon:</strong> ${result.vcard_phone}<br>`;
                if (result.vcard_email) infoHtml += `<strong>Email:</strong> ${result.vcard_email}<br>`;
                if (result.vcard_organization) infoHtml += `<strong>Szervezet:</strong> ${result.vcard_organization}<br>`;
                if (result.email_address) infoHtml += `<strong>Email:</strong> ${result.email_address}<br>`;
                if (result.email_subject) infoHtml += `<strong>T√°rgy:</strong> ${result.email_subject}<br>`;
                if (result.sms_phone) infoHtml += `<strong>SMS Telefon:</strong> ${result.sms_phone}<br>`;
                if (result.sms_message) infoHtml += `<strong>√úzenet:</strong> ${result.sms_message}<br>`;
                if (result.phone_number) infoHtml += `<strong>Telefon:</strong> ${result.phone_number}<br>`;
                
                if (!result.url && !result.text && !result.wifi_ssid && !result.bluetooth_mac && 
                    !result.vcard_name && !result.email_address && !result.sms_phone && !result.phone_number) {
                    infoHtml += '<em>Nincs NDEF √ºzenet a c√≠mk√©n vagy ismeretlen t√≠pus</em>';
                }
                tagInfoEl.innerHTML = infoHtml;

                statusEl.className = 'status success';
                if (result.record_type === 'uri' && result.url) {
                    statusEl.textContent = `‚úÖ URL olvasva: ${result.url}`;
                    try {
                        await open(result.url);
                        statusEl.textContent += ' ‚Üí URL megnyitva a b√∂ng√©sz≈ëben!';
                    } catch (openError) {
                        console.error('URL megnyit√°si hiba:', openError);
                    }
                } else if (result.record_type === 'text' && result.text) {
                    statusEl.textContent = `‚úÖ Sz√∂veg olvasva: ${result.text}`;
                } else if (result.record_type) {
                    statusEl.textContent = `‚úÖ ${typeNames[result.record_type] || 'Rekord'} olvasva`;
                } else {
                    statusEl.className = 'status info';
                    statusEl.textContent = '‚ÑπÔ∏è C√≠mke olvasva, de nincs NDEF √ºzenet.';
                }
            } catch (error) {
                readBtn.disabled = false;
                readBtn.textContent = 'NDEF √ºzenet olvas√°sa NTAG216 c√≠mk√©b≈ël';
                
                statusEl.className = 'status error';
                statusEl.textContent = `‚ùå Hiba: ${error}`;
            }
        };

        // URL olvas√°sa (kompatibilit√°s)
        window.readUrl = async function() {
            await window.readNdef();
        };

        // Oldal bet√∂lt√©sekor NFC ellen≈ërz√©s
        checkNFC();
    </script>
</body>
</html>

